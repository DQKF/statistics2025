<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>教學講義 | 陳陸輝教授社會科學統計實作</title>
 <style>
  body {
  max-width: 1400px;
  margin: 0 auto;
  padding: 30px;
  font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
  line-height: 1.8;
  background: #fafafa;
  color: #2c3e50;
  font-size: 24px !important;  /* 建議用 22px，28px 可能太大 */
}

 /* 程式碼區塊基本樣式 */
pre code {
  font-size: 22px !important;  /* 從 18px 改成 22px */
  line-height: 1.65 !important;
  display: block;
  padding: 12px;
  background: #fff !important;
  border: 1px solid #e1e8ed;
  border-radius: 8px;
  overflow-x: auto;
  white-space: pre;
  margin: 5px 0; 
}
/* 可折疊區塊 */
details {
  margin: 20px 0;
}

summary {
  font-size: 1.2rem;
  font-weight: bold;
  cursor: pointer;
  padding: 16px 20px;
  background: linear-gradient(135deg, #f0f8ff, #e6f3ff);
  border-radius: 8px;
  border-left: 6px solid #3498db;
  transition: all 0.3s;
}

summary:hover {
  background: #d6eaff;
}

/* 這一段只控制 details 裡的內文行距與段落間距 */
details .tips-block p {
  line-height: 1.4 !important;
  margin: 0.2em  !important;
}

 /* 頁首 */
.hero h1 {
  font-size: 2.5rem;
  text-align: center;
  margin: 20px 0;
  color: #2c3e50;
  line-height: 1.2;   /* 縮減行距 */
  font-family: 'Noto Sans TC', 'Microsoft JhengHei UI', sans-serif;
}

.hero p {
  text-align: center;
  font-size: 1.5rem;
  margin: 4px 0;      /* 比原本 8px 再貼一點 */
  color: #34495e;
  line-height: 1.3;   /* 縮減行距 */
  font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
}

    /* 圖表容器（可保留） */
    .chart-container {
      margin: 40px auto;
      text-align: center;
      padding: 25px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      max-width: 1100px;
    }

    /* 頁尾 */
    .footer {
      text-align: center;
      margin-top: 80px;
      padding: 30px;
      color: #7f8c8d;
      border-top: 2px solid #ecf0f1;
      font-size: 1.1rem;
    }

    /* 目錄：淺藍底＋放大字（套用在 <pre><code> 內的指定行） */
    pre code .toc-banner {
      display: block;              /* 每行各自一列 */
      background: #e6f2ff;         /* 淺藍底 */
      color: #2c3e50;
      font-size: 26px !important;  /* 由 18px 放大到 22px */
      font-weight: 700;
      padding: 6px 12px;
      border-radius: 6px;
      margin: 0 0 6px 0;           /* 行距 */
    }

/* Step：淺綠底＋放大字（套用在 <pre><code> 內的指定行） */
    pre code .btoc-banner {
      display: block;              /* 每行各自一列 */
      background: #bffff3;         /* 淺綠底 */
      color: #2c3e50;
      font-size: 24px !important;  /* 由 18px 放大到 28px */
      font-weight: 700;
      padding: 6px 12px;
      border-radius: 6px;
      margin: 0 0 6px 0;           /* 行距 */
    }

/* Step：淺灰底＋一般大小字形（套用在 <pre><code> 內的指定行） */
    pre code .ctoc-banner {
      display: block;              /* 每行各自一列 */
      background: #e9e9e9;         /* 淺綠底 */
      color: #2c3e50;
      font-size: 18px !important;  /* 由 18px */
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 6px;
      margin: 0 0 3px 0;           /* 行距 */
    }
/* Step：淺灰底＋一般大小字形（套用在 <pre><code> 內的指定行） */
    pre code .ttoc-banner {
      display: block;              /* 每行各自一列 */
      background: #e9fade;         /* 淺綠底 */
      color: #2c3e50;
      font-size: 28px !important;  /* 由 18px */
      font-weight: 600;
      padding: 3px 6px;
      border-radius: 6px;
      margin: 0 0 0px 0;           /* 行距 */
    }

  </style>
</head>
<body>

  <div class="hero">
    <h1>國立政治大學選舉研究中心 陳陸輝教授<br>社會科學統計實作</h1>
    <p><strong>Week01 - R for Descriptive Statistics & Tests of Association</strong></p>
    <p>日期：2025年12月04日</p>
    <p>講員：倪世傑 博士</p>
    <p>E-mail：georgenee0502@gmail.com</p>
  </div>

  <details open>
    <summary>學習目標</summary>

  <div class="tips-block">
    <p>Pearson 積差相關分析
  </div>
</details></p> </summary>
    <pre><code class="language-r">=============================================================
國立政治大學選研中心陳陸輝教授社會科學統計實作
Week01- R for Descriptive Statistics & Tests of Association 
Date:2025-12-04
講員:倪世傑 博士
E-mail:georgenee0502@gmail.com
=============================================================
<span class="toc-banner">目錄</span>
1.資料簡述與研究主旨
2.變項其所在位置
3.Chi-square 卡方獨立性檢定前的說明
4.資料清理A:對蔡英文總統國防政策的滿意程度
  Step 01 載入資料
  Step 02 查看與資料清理
  Step 03 建立新的dataframe以進行資料清理
  Step 04 查看data manipulation後的狀況
5.清理資料B:恢復政黨命名
  Step 01 資料清理
  Step 02 建立新的工作用資料框
  Step 03 資料轉換A
  Step 04 資料轉換B
  Step 05 資料轉換C
  Step 06 資料轉換D
  Step 07 資料轉換E
  Step 08 資料轉換F
  Step 09 資料轉換G
6.合併資料
7.卡方獨立性檢定
8.卡方同質性檢定 Cramer's V
9.視覺化
  Step 01 安裝套件
  Step 02 在視覺化資料需再清理, 徹底消除遺漏值 NA
  Step 03 計算比例
  Step 04 繪製堆疊長條圖
  Step 05 save as .png file
10.存檔

<span class="toc-banner">1.資料簡述與研究主旨</span>
採用資料：原檔案為TEDS2024-T_PAO3.sav,
        原檔案TEDS2024-T_PAO35.sav 轉存為 C.csv.
研究對象：[對蔡英文總統的國防政策的滿意度] 與 
        [民眾的政黨支持狀態] 之間的關聯性。

<span class="toc-banner">2.變項及其所在位置</span>
       變項                變項內容          所在位置      變項類型
 1.對蔡英文國防政策的滿意程度  Likert 4 level   C$q9        ordinal
 2.對韓國瑜的好感度          0-10             C$q19       numeric
 3.對蔡英文的信任度          0-10             C$q13       numeric
 4.政黨支持對象             政黨類別          C$q26:28   categorical

<span class="toc-banner">3.Chi-square 卡方獨立性檢定前的說明</span>
Chi-square 卡方獨立性檢定
The relationship between categorical variables 
檢定對象
對蔡英文總統在國防方面的表現是否滿意 （滿意、不滿意） Vs.
黨派傾向 （泛藍陣營、泛綠陣營、台灣民眾黨、不偏）
虛無假設 (H0)： Natl_Defence 與 partisanship_N 兩變數是互相獨立的（即沒有關聯）。
對立假設 (Ha)：Natl_Defence 與 partisanship_N 兩變數是不獨立（即存在顯著關聯）。

Next Step 
 ５．那您對她(蔡英文總統)在國防方面的表現滿不滿意 : (C$q9)
      ## 1. 非常滿意 + 2. 有點滿意 ＝＝ 滿意
      ## 3. 不太滿意 + 4. 非常不滿意 ＝＝ 不滿意
      ## else == NA

現在先認識/重整資料。

<span class="toc-banner">4.資料清理A:對蔡英文總統國防政策的滿意程度</span>
<span class="btoc-banner">Step 01 載入資料</span>
<span class="ctoc-banner">install.packages("haven")</span> load sav, xlsx等資料用。
<span class="ctoc-banner">install.packages("dplyr")</span> 處理和轉換資料框的核心套件。
<span class="ctoc-banner">install.packages("sjPlot")</span>美化統計表格、圖表和簡化數據操作的套件組合。
<span class="ctoc-banner">install.packages("sjmisc")</span>美化統計表格、圖表和簡化數據操作的套件組合。
<span class="ctoc-banner">library(haven) 
library(dplyr) 
library(sjPlot) 
library(sjmisc) </span>
<span class="ctoc-banner">TEDS2024_T_PA03 <- read_sav("TEDS2024-T_PA03.sav")</span>
<span class="ctoc-banner">View(TEDS2024_T_PA03)</span>
名稱太長了，對吧？複製一個簡化的版本暫存值 C。
以後這個“C”會跟著我們走到課程結束。

<span class="ctoc-banner">C <- TEDS2024_T_PA03</span>
先存檔！
<span class="ctoc-banner">write.csv(C,"C.csv")</span>

<span class="btoc-banner">Step 02 查看與資料清理</span>
<span class="ctoc-banner">frq(C$q9)</span>
5.那您對蔡英文在國防方面的表現滿不滿意? (x) <numeric> 
total N=1202 valid N=1202 mean=14.62 sd=32.00

Value |      Label |   N | Raw % | Valid % | Cum. %
---------------------------------------------------
   1 |   非常滿意 | 283 | 23.54 |   23.54 |  23.54
   2 |   有點滿意 | 352 | 29.28 |   29.28 |  52.83
   3 |   不太滿意 | 253 | 21.05 |   21.05 |  73.88
   4 | 非常不滿意 | 158 | 13.14 |   13.14 |  87.02
  95 |      拒答 |  10 |  0.83 |    0.83 |  87.85
  96 |     很難說 |  11 |  0.92 |    0.92 |  88.77
  97 |     無意見 |  40 |  3.33 |    3.33 |  92.10
  98 |     不知道 |  95 |  7.90 |    7.90 | 100.00
  nA |        nA |   0 |  0.00 |      nA |   nA

<span class="btoc-banner">Step 03 建立新的dataframe以進行資料清理</span>
目的
維持 C 不受任何更動影響，永保資料的乾淨。
<span class="ctoc-banner">C9 <- C[c("q9")] </span>
data manipulation
目的
設定新的column : Natl_Defence
合併 1, 2 == 滿意, 3,4 == 不滿意
將95:98設定為NA
<span class="ctoc-banner">C9$Natl_Defence <- case_when(
                              C9$q9 %in% c("1","2") ~ "滿意",
                              C9$q9 %in% c("3","4") ~ "不滿意",
                              C9$q9 %in% c("95","96","97","98") ~ NA_character_,
                              )</span>
case_when()：R Package dplyr下的資料重編碼 (Data Recoding) 步驟

由於 C9$Natl_Defence 係類別變項，需設定。
<span class="ctoc-banner">C9$Natl_Defence <- as.factor(C9$Natl_Defence)</span>

<span class="btoc-banner">Step 04 查看data manipulation後的狀況</span>
<span class="ctoc-banner">frq(C9$Natl_Defence)</span>
x <character> 
total N=1202 valid N=1046 mean=1.61 sd=0.49

Value  |   N | Raw % | Valid % | Cum. %
#---------------------------------------
不滿意  | 411 | 34.19 |   39.29 |  39.29
滿意    | 635 | 52.83 |   60.71 | 100.00
  nA   | 156 |  12.98 |     nA |   nA


<span class="toc-banner">5.清理資料B:恢復政黨命名</span>
<span class="btoc-banner">Step01 資料清理</span>
1)合併問題組20.21.22 
在國內的政黨之中，請問您認為您比較支持哪一個政黨？（回答「選人不選黨」者，
         ## 請追問「非選舉時期」整體而言較支持哪一個政黨）

2)建立new column，恢復代碼的名稱「本來面目」。需對照問卷。
<span class="ctoc-banner">C$q26_New <- recode(C$q26,
   "1"  = "國民黨",
   "2"  = "民進黨",
   "3"  = "新黨",
   "4"  = "親民黨",
   "5"  = "臺聯",
   "20"  = "綠黨",
  "21"  = "時代力量",
  "23"  = "社民黨",
  "35"  = "台灣基進",
  "38"  = "台灣民眾黨",
  "6"   = "都支持",
  "7"   = "都不支持",
  "96"  = "看情形",
  "97"  = "無意見",
  "98"  = "不知道",
  "95"  = "拒答",
  "90"  = "其他"
)</span>

<span class="ctoc-banner">C$q28_New <- recode(C$q28,
   "3"  = "國民黨",
   "4"  = "民進黨",
   "5"  = "新黨",
   "5"  = "親民黨",
   "7"  = "臺聯",
  "23"  = "綠黨",
  "24"  = "時代力量",
  "26"  = "社民黨",
  "38"  = "台灣基進",
  "41"  = "台灣民眾黨",
  "8"   = "都不偏",
  "96"  = "看情形",
  "97"  = "無意見",
  "98"  = "不知道",
  "95"  = "拒答",
  "90"  = "其他"
)</span>

<span class="btoc-banner">Step 02 建立新的工作用資料框</span>
<span class="ctoc-banner">C2628<-C[c("q26_New", "q28_New")]</span>

<span class="btoc-banner">Step 03 資料轉換A</span>
<span class="ctoc-banner">C2628$partisanship <- case_when(
  C2628$q26_New %in% c("19", 
                       "都支持",
                       "都不支持",
                       "看情形",
                       "無意見",
                       "不知道",
                       "拒答",
                       "其他") 
                              ~ C2628$q28_New,
                       TRUE   ~ C2628$q26_New
                       ) </span>
                      # 當在q26_New中出現以上，在new column “partisanship”中
                      # 改為 q28_New 的 cell value
                      # 其餘的維持 q26_New的cell value。
<span class="ctoc-banner">frq(C2628$partisanship)</span>
x <categorical> 
total N=1202 valid N=1202 mean=3.40 sd=3.03

Value      |   N | Raw % | Valid % | Cum. %
-------------------------------------------
國民黨     | 230 | 19.13 |   19.13 |  19.13
民進黨     | 441 | 36.69 |   36.69 |  55.82
都不偏     | 264 | 21.96 |   21.96 |  77.79
17        |   1 |  0.08 |    0.08 |  77.87
19        |   1 |  0.08 |    0.08 |  77.95
21        |   7 |  0.58 |    0.58 |  78.54
台灣民眾黨  | 209 | 17.39 |   17.39 |  95.92
拒答       |   8 |  0.67 |    0.67 |  96.59
看情形     |   6 |  0.50 |    0.50 |  97.09
無意見     |   1 |  0.08 |    0.08 |  97.17
不知道     |   9 |  0.75 |    0.75 |  97.92
99        |   0 |  0.00 |    0.00 |  97.92
親民黨     |   3 |  0.25 |    0.25 |  98.17
臺聯       |   1 |  0.08 |    0.08 |  98.25
都支持     |   0 |  0.00 |    0.00 |  98.25
都不支持   |   0 |  0.00 |    0.00 |  98.25
綠黨      |   1 |  0.08 |    0.08 |  98.34
時代力量   |  14 |  1.16 |    1.16 |  99.50
台灣基進   |   3 |  0.25 |    0.25 |  99.75
46        |   3 |  0.25 |    0.25 | 100.00
nA.       |   0 |  0.00 |      nA |   nA

<span class="btoc-banner">Step 04 資料轉換B </span>
重新設定 17, 19, 21 == "都不偏"
<span class="ctoc-banner">C2628$partisanship <- case_when(
                                C2628$partisanship %in% 
                                c("17", "19", "21") ~ "都不偏",
                                TRUE ~ C2628$partisanship
                                )</span>
<span class="ctoc-banner">C2628$partisanship <- as.factor(C2628$partisanship)</span>
<span class="ctoc-banner">frq(C2628$partisanship)</span>
x <categorical> 
total N=1202 valid N=1202 mean=8.02 sd=3.65

Value      |   N | Raw % | Valid % | Cum. %
-------------------------------------------
46         |   3 |  0.25 |    0.25 |   0.25
不知道      |   9 |  0.75 |    0.75 |   1.00
台灣基進    |   3 |  0.25 |    0.25 |   1.25
台灣民眾黨  | 209 | 17.39 |   17.39 |  18.64
國民黨      | 230 | 19.13 |   19.13 |  37.77
拒答       |   8 |  0.67 |    0.67 |  38.44
時代力量    |  14 |  1.16 |    1.16 |  39.60
民進黨     | 441 | 36.69 |   36.69 |  76.29
無意見     |   1 |  0.08 |    0.08 |  76.37
看情形     |   6 |  0.50 |    0.50 |  76.87
綠黨       |   1 |  0.08 |    0.08 |  76.96
臺聯       |   1 |  0.08 |    0.08 |  77.04
親民黨     |   3 |  0.25 |    0.25 |  77.29
都不偏     | 273 | 22.71 |   22.71 | 100.00
nA        |   0 |  0.00 |      nA |   nA

<span class="btoc-banner">Step 05 資料轉換C</span>
重新設定 46, 不知道...  == 遺漏值
<span class="ctoc-banner">C2628$partisanship <- case_when(
                                C2628$partisanship %in% 
                                c("46",
                                  "不知道",
                                  "拒答",
                                  "無意見"
                                  ,"看情形") 
                                  ~ NA_character_,
                                  TRUE ~ C2628$partisanship
                                )</span>
<span class="ctoc-banner">C2628$partisanship <- as.factor(C2628$partisanship)</span>
<span class="ctoc-banner">frq(C2628$partisanship)</span>
x <categorical> 
total N=1202 valid N=1175 mean=4.99 sd=2.49

Value      |   N | Raw % | Valid % | Cum. %
-------------------------------------------
台灣基進   |   3 |  0.25 |    0.26 |   0.26
台灣民眾黨 | 209 | 17.39 |   17.79 |  18.04
國民黨     | 230 | 19.13 |   19.57 |  37.62
時代力量   |  14 |  1.16 |    1.19 |  38.81
民進黨     | 441 | 36.69 |   37.53 |  76.34
綠黨       |   1 |  0.08 |    0.09 |  76.43
臺聯       |   1 |  0.08 |    0.09 |  76.51
親民黨     |   3 |  0.25 |    0.26 |  76.77
都不偏     | 273 | 22.71 |   23.23 | 100.00
nA        |  27 |  2.25 |      nA |   nA

<span class="btoc-banner">Step 06 資料轉換D</span>
  在new column partisanship_N 中，合併小黨為四大政團：四分法。
台灣基進,時代力量,民進黨,綠黨,臺聯 == 泛綠陣營
國民黨, 親民黨 ＝＝泛藍
台灣民眾黨 == 台灣民眾黨
都不偏 == 都不偏
NA==NA
<span class="ctoc-banner">C2628$partisanship_N <- case_when(
                          C2628$partisanship %in% 
                          c("台灣基進",
                            "時代力量",
                            "民進黨",
                            "綠黨",
                            "臺聯") ~ "泛綠陣營",
  C2628$partisanship %in% c("國民黨",
                            "親民黨") ~ "泛藍陣營",
  C2628$partisanship == "台灣民眾黨" ~ "台灣民眾黨",
  C2628$partisanship == "都不偏" ~ "都不偏",
  is.na(C2628$partisanship) ~ NA_character_,
  TRUE ~ NA_character_  # 其他未分類的也設為 NA
)</span>
<span class="ctoc-banner">C2628$partisanship_N <- as.factor(C2628$partisanship_N)</span>
<span class="ctoc-banner">frq(C2628$partisanship_N)</span>
x <categorical> 
total N=1202 valid N=1175 mean=2.49 sd=1.03

Value      |   N | Raw % | Valid % | Cum. %
-------------------------------------------
台灣民眾黨 | 209 | 17.39 |   17.79 |  17.79
泛綠陣營   | 460 | 38.27 |   39.15 |  56.94
泛藍陣營   | 233 | 19.38 |   19.83 |  76.77
都不偏    | 273 | 22.71 |   23.23 | 100.00
nA       |  27 |  2.25 |      nA |   nA

<span class="btoc-banner">Step 07 資料轉換E</span>
在new column partisanship_N2 中，
合併四大政團為三種：三分法。
泛綠陣營 == 泛綠陣營
泛藍陣營 ＝＝泛藍陣營
台灣民眾黨 == 台灣民眾黨
都不偏 == NA
NA == NA

<span class="ctoc-banner">C2628$partisanship_N2 <- case_when(
  C2628$partisanship_N %in% "泛綠陣營" ~ "泛綠陣營",
  C2628$partisanship_N %in% "泛藍陣營" ~ "泛藍陣營",
  C2628$partisanship_N == "台灣民眾黨" ~ "台灣民眾黨",
  C2628$partisanship_N == "都不偏" ~ NA_character_,
  is.na(C2628$partisanship_N) ~ NA_character_,
  TRUE ~ NA_character_  # 其他未分類的也設為 NA
)</span>
<span class="ctoc-banner">C2628$partisanship_N2 <- as.factor(C2628$partisanship_N2)</span>
<span class="ctoc-banner">frq(C2628$partisanship_N2)</span>
x <categorical> 
total N=1202 valid N=902 mean=2.03 sd=0.70

Value      |   N | Raw % | Valid % | Cum. %
-------------------------------------------
台灣民眾黨 | 209 | 17.39 |   23.17 |  23.17
泛綠陣營   | 460 | 38.27 |   51.00 |  74.17
泛藍陣營   | 233 | 19.38 |   25.83 | 100.00
nA       |  300 | 24.96 |      nA |   nA

<span class="btoc-banner">Step 08 資料轉換F</span>
在new column partisanship_N2 中，
合併四大政團為二種：二分法。
泛綠陣營 == 泛綠陣營
藍白陣營 ＝＝泛藍陣營 + 台灣民眾黨
NA==NA
<span class="ctoc-banner">C2628$partisanship_N3 <- case_when(
  C2628$partisanship_N2 %in% "泛綠陣營" ~ "泛綠陣營",
  C2628$partisanship_N2 %in% c("泛藍陣營","台灣民眾黨") ~ "藍白陣營",
  is.na(C2628$partisanship_N2) ~ NA_character_,
  TRUE ~ NA_character_  # 其他未分類的也設為 NA
)</span>
<span class="ctoc-banner">C2628$partisanship_N3 <- as.factor(C2628$partisanship_N3)</span>
<span class="ctoc-banner">frq(C2628$partisanship_N3)</span>
x <categorical> 
total N=1202 valid N=902 mean=1.49 sd=0.50

Value    |   N | Raw % | Valid % | Cum. %
-----------------------------------------
泛綠陣營 | 460 | 38.27 |      51 |     51
藍白陣營 | 442 | 36.77 |      49 |    100
nA      | 300 | 24.96 |     nA  |     nA

<span class="toc-banner">6.合併資料</span>
<span class="ctoc-banner">nrow(C9)</span>
[1] 1202
<span class="ctoc-banner">nrow(C2628)</span>
[1] 1202
<span class="ctoc-banner">CA1 <- cbind(C9, C2628)</span>
<span class="ctoc-banner">nrow(CA1)</span>
[1] 1202

<span class="toc-banner">7.卡方獨立性檢定</span>
判斷兩個變數之間是否相互關聯 (是否有 association)。
檢驗四個主要政黨支持群體:台灣民眾黨、泛綠陣營、泛藍陣營與都不偏 的受訪者，
在對蔡英文總統國防政策的滿意度上是否具有關聯性 (association)。
虛無假設：台灣民眾的政黨認同與蔡總統的國防政策滿意度之間沒有關聯性。
對立假設：台灣民眾的政黨認同與蔡總統的國防政策滿意度之間具有關聯性。

<span class="ctoc-banner">levels(CA1$Natl_Defence)</span>
[1] "不滿意" "滿意"  
<span class="ctoc-banner">levels(CA1$partisanship_N)</span>
[1] "台灣民眾黨" "泛綠陣營"   "泛藍陣營" "都不偏" 
<span class="ctoc-banner">chisq.test(CA1$Natl_Defence,CA1$partisanship_N)</span>
Pearson's Chi-squared test

data:  CA1$Natl_Defence and CA1$partisanship_N
X-squared = 362.85, df = 3, p-value < 2.2e-16

結論
p-value == 2.2e-16 < .05，拒絕虛無假設（兩者之間無關連性）。
受訪民眾的政治傾向與對蔡總統的國防相關政策態度之間存在高度顯著的關聯性。
說明
X-squared 就是「卡方統計量」，是「實際資料」跟「虛無假設下預期表格」差多遠的指標。
X-squared = 362.85, df = 3：
代表實際列聯表與「政黨認同與國防政策滿意度彼此獨立」時的預期列聯表差異非常大。

<span class="toc-banner">8.卡方同質性檢定 Cramer's V</span>
判斷一個變數在不同群組中的分佈是否相同 (是否 Homogeneous)。
檢驗四個主要政黨支持群體:台灣民眾黨、泛綠陣營、泛藍陣營與都不偏
在對蔡英文總統國防政策的滿意度的分佈上顯著不同。
虛無假設
各政黨認同群體在蔡總統國防政策滿意度上的分佈相同，
也就是說「政黨認同與國防政策滿意度」之間沒有系統性關聯。
對立假設
至少有一個政黨支持群體的滿意度分佈不同於其它群體，
也就是說「政黨認同與國防政策滿意度」之間存在關聯。

<span class="ctoc-banner">install.packages("rcompanion")</span>
<span class="ctoc-banner">library(rcompanion)</span>
<span class="ctoc-banner">cramerV(CA1$Natl_Defence,CA1$partisanship_N)</span>
<span class="ctoc-banner">Cramer V</span>
# 0.3885

說明
Cramer’s V == 0.389
依 Jacob Cohen 門檻 .1/.3/.5），屬中～偏大效果。
Jacob Cohen |0.1| 弱 |0.3| 中等 |0.5|強
結論
不同政黨的支持者，對蔡英文的國防政策滿意度分佈明顯不一樣，
而且差異大小大約是「中等偏大」這個等級。在卡方檢定 p-value 極小（p < .001）的前提下，
我們拒絕虛無假設，認為政黨認同與國防政策滿意度之間具有統計上顯著且實質上不算小的關聯性。

<span class="toc-banner">9.視覺化</span>
<span class="btoc-banner">Step 01 安裝套件</span>
<span class="ctoc-banner">install.packages("forcats")</span>  編碼與排列
<span class="ctoc-banner">install.packages("tidyr") </span>   資料展開
<span class="ctoc-banner">install.packages("ggplot2") </span> 繪圖用
<span class="ctoc-banner">install.packages("showtext")</span> 顯示中文字體

<span class="ctoc-banner">library(forcats)
library(tidyr)
library(ggplot2)
library(showtext)</span>
<span class="btoc-banner">Step 02 在視覺化資料需再清理, 徹底消除遺漏值 NA</span>
<span class="ctoc-banner">CA1c <- CA1 %>%
  mutate(
    Natl_Defence   = factor(na_if(as.character(Natl_Defence), "NA")),
    partisanship_N = factor(na_if(as.character(partisanship_N), "NA"))
  ) %>%
  drop_na(Natl_Defence, partisanship_N) %>%  # 去掉真的 NA 的列
  mutate(
    # 可選：重新排序層級
    Natl_Defence   = fct_relevel(Natl_Defence, "不滿意", "滿意"),
    partisanship_N = fct_relevel(partisanship_N, "泛綠陣營","泛藍陣營","台灣民眾黨","都不偏")
  ) %>%
  droplevels()</span>

<span class="ctoc-banner">nrow(CA1c)</span>
#[1] 1029

# 查看 NA 是否去除
<span class="ctoc-banner">frq(CA1c$Natl_Defence)</span>
x <categorical> 
total N=1029 valid N=1029 mean=1.61 sd=0.49

Value  |   N | Raw % | Valid % | Cum. %
---------------------------------------
不滿意 | 404 | 39.26 |   39.26 |  39.26
滿意   | 625 | 60.74 |   60.74 | 100.00
nA    |   0 |  0.00 |      nA |   nA


<span class="ctoc-banner">frq(CA1c$partisanship_N)</span>
x <categorical> 
total N=1029 valid N=1029 mean=2.17 sd=1.18

Value      |   N | Raw % | Valid % | Cum. %
#-------------------------------------------
泛綠陣營   | 426 | 41.40 |   41.40 |  41.40
泛藍陣營   | 207 | 20.12 |   20.12 |  61.52
台灣民眾黨 | 186 | 18.08 |   18.08 |  79.59
都不偏     | 210 | 20.41 |   20.41 | 100.00
nA        |   0 |  0.00 |      nA |   nA

<span class="btoc-banner">Step 03 計算比例</span>
<span class="ctoc-banner">prop_data <- CA1c %>%
  group_by(partisanship_N, Natl_Defence) %>%
  summarise(n = n(), .groups = "drop") %>%
  group_by(partisanship_N) %>%
  mutate(
    prop = n / sum(n),
    pct = round(prop * 100, 1)
  )</span>
<span class="ctoc-banner">prop_data</span>
A tibble: 8 × 5
Groups:   partisanship_N [4]
 partisanship_N Natl_Defence     n   prop   pct
 <fct>          <fct>        <int>  <dbl> <dbl>
1 泛綠陣營       不滿意          29  0.0681   6.8
2 泛綠陣營       滿意           397  0.932   93.2
3 泛藍陣營       不滿意         163  0.787   78.7
4 泛藍陣營       滿意            44  0.213   21.3
5 台灣民眾黨     不滿意         111  0.597   59.7
6 台灣民眾黨     滿意            75  0.403   40.3
7 都不偏        不滿意         101  0.481   48.1
8 都不偏        滿意           109  0.519   51.9

<span class="btoc-banner">Step 04 繪製堆疊長條圖</span>
<span class="ctoc-banner">p_國防滿意度 <- ggplot(prop_data, aes(x = partisanship_N, y = prop, fill = Natl_Defence)) +
  geom_col(position = "stack", width = 0.7) +
  geom_text(aes(label = paste0(pct, "%")),
            position = position_stack(vjust = 0.5),
            size = 5, fontface = "bold", color = "white") +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_manual(values = c("不滿意" = "#e74c3c", "滿意" = "#3498db")) +
  labs(
    title = "各政黨傾向對國防的滿意度分布",
    x = "政黨傾向",
    y = "比例",
    fill = "國防滿意度"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 12, face = "bold"),
    legend.position = "bottom",
    panel.grid.major.x = element_blank()
  )</span>
<span class="ctoc-banner">print(p_國防滿意度)</span>

<span class="btoc-banner">Step 05 save as .png file</span>
<span class="ctoc-banner">ggsave(
  filename = "各政黨_國防滿意度.png",
  plot     = p_國防滿意度,
  device   = "png",
  width    = 8,      # 寬度（英吋）
  height   = 5,      # 高度（英吋）
  dpi      = 300,    # 解析度
  bg       = "white" # 背景（避免透明背景）
)</span>
<span class="toc-banner">10.存檔</span>
<span class="ctoc-banner">write.csv(C2628,"C2628.csv")</span>
<span class="ctoc-banner">write.csv(CA1,"CA1.csv")</span>
<span class="ctoc-banner">write.csv(CA1c,"CA1c.csv")</span>
<span class="ctoc-banner">save.image("你的命名.RData")</span>
</code></pre>
  <div class="footer">
    <p>倪世傑 George S. J. Nee © 2025</p>
  </div>
</body>
</html>
</html>