<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>教學講義 | 陳陸輝教授社會科學統計實作</title>
 <style>
  body {
  max-width: 1400px;
  margin: 0 auto;
  padding: 30px;
  font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
  line-height: 1.8;
  background: #fafafa;
  color: #2c3e50;
  font-size: 24px !important;  /* 建議用 22px，28px 可能太大 */
}

 /* 程式碼區塊基本樣式 */
pre code {
  font-size: 22px !important;  /* 從 18px 改成 22px */
  line-height: 1.65 !important;
  display: block;
  padding: 12px;
  background: #fff !important;
  border: 1px solid #e1e8ed;
  border-radius: 8px;
  overflow-x: auto;
  white-space: pre;
  margin: 5px 0; 
}
/* 可折疊區塊 */
details {
  margin: 20px 0;
}

summary {
  font-size: 1.2rem;
  font-weight: bold;
  cursor: pointer;
  padding: 16px 20px;
  background: linear-gradient(135deg, #f0f8ff, #e6f3ff);
  border-radius: 8px;
  border-left: 6px solid #3498db;
  transition: all 0.3s;
}

summary:hover {
  background: #d6eaff;
}

/* 這一段只控制 details 裡的內文行距與段落間距 */
details .tips-block p {
  line-height: 1.4 !important;
  margin: 0.2em  !important;
}

 /* 頁首 */
.hero h1 {
  font-size: 2.5rem;
  text-align: center;
  margin: 20px 0;
  color: #2c3e50;
  line-height: 1.2;   /* 縮減行距 */
  font-family: 'Noto Sans TC', 'Microsoft JhengHei UI', sans-serif;
}

.hero p {
  text-align: center;
  font-size: 1.5rem;
  margin: 4px 0;      /* 比原本 8px 再貼一點 */
  color: #34495e;
  line-height: 1.3;   /* 縮減行距 */
  font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
}

    /* 圖表容器（可保留） */
    .chart-container {
      margin: 40px auto;
      text-align: center;
      padding: 25px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      max-width: 1100px;
    }

    /* 頁尾 */
    .footer {
      text-align: center;
      margin-top: 80px;
      padding: 30px;
      color: #7f8c8d;
      border-top: 2px solid #ecf0f1;
      font-size: 1.1rem;
    }

    /* 目錄：淺藍底＋放大字（套用在 <pre><code> 內的指定行） */
    pre code .toc-banner {
      display: block;              /* 每行各自一列 */
      background: #e6f2ff;         /* 淺藍底 */
      color: #2c3e50;
      font-size: 26px !important;  /* 由 18px 放大到 22px */
      font-weight: 700;
      padding: 6px 12px;
      border-radius: 6px;
      margin: 0 0 6px 0;           /* 行距 */
    }

/* Step：淺綠底＋放大字（套用在 <pre><code> 內的指定行） */
    pre code .btoc-banner {
      display: block;              /* 每行各自一列 */
      background: #bffff3;         /* 淺綠底 */
      color: #2c3e50;
      font-size: 24px !important;  /* 由 18px 放大到 28px */
      font-weight: 700;
      padding: 6px 12px;
      border-radius: 6px;
      margin: 0 0 6px 0;           /* 行距 */
    }

/* Step：淺灰底＋一般大小字形（套用在 <pre><code> 內的指定行） */
    pre code .ctoc-banner {
      display: block;              /* 每行各自一列 */
      background: #e9e9e9;         /* 淺綠底 */
      color: #2c3e50;
      font-size: 18px !important;  /* 由 18px */
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 6px;
      margin: 0 0 3px 0;           /* 行距 */
    }
/* Step：淺灰底＋一般大小字形（套用在 <pre><code> 內的指定行） */
    pre code .ttoc-banner {
      display: block;              /* 每行各自一列 */
      background: #e9fade;         /* 淺綠底 */
      color: #2c3e50;
      font-size: 28px !important;  /* 由 18px */
      font-weight: 600;
      padding: 3px 6px;
      border-radius: 6px;
      margin: 0 0 0px 0;           /* 行距 */
    }

  </style>
</head>
<body>

  <div class="hero">
    <h1>國立政治大學選舉研究中心 陳陸輝教授<br>社會科學統計實作</h1>
    <p><strong>Week03 推論統計：累積對數勝算模型</strong></p>
    <p>日期：2025年12月18日</p>
    <p>講員：倪世傑 博士</p>
    <p>E-mail：georgenee0502@gmail.com</p>
  </div>

  <details open>
    <summary>學習目標</summary>

  <div class="tips-block">
    <p>累積對數勝算模型, CLM
  </div>
</details></p> </summary>
    <pre><code class="language-r">===========================================================
國立政治大學選研中心陳陸輝教授社會科學統計實作
Week03 推論統計:累計對數勝算模型 Cumulative Logit Model, CLM  
Date:2025-12-18 
講員:倪世傑 博士
E-mail:georgenee0502@gmail.com
===========================================================

<span class="ttoc-banner">
重點提示
1. 累積對數勝算模型（cumulative logit model）
   適用對象是 dep.variable，
   類別之間的距離不一定相等，也不知道「差多少」，
   從「變不好 → 差不多」不一定等於「差不多 → 變好」那樣的一段距離，
   所以不適合直接當連續變數跑OLS。
   這種情況下，cumulative logit特別適合，因為它只需要「順序」，
   不需要假設間距完全相等。

2. 以本次回規模型，對於「未來半年經濟狀況」（變不好／差不多／變好），
   模型分別估計兩個累積對比：
  （1）「變不好」相對於「差不多或變好」，以及
  （2）「變不好或差不多」相對於「變好」。
   自變項的迴歸係數在這兩個累積對比上被假設為相同（比例勝算假設），
   因此可被解讀為：自變項增加一單位，受訪者落在「較樂觀經濟評價（靠右側類別）」
   的累積勝算會乘上一個固定倍數。

3. 在這一次回歸模型的tutoring中，我們會運用到兩個模型：兩個模型真正的差別在於：
   （1）m_clm2：採用 trust_Tsai_N（ordinal factor），R 自動用
   正交多項式對比(orthogonal polynomial contrasts)(L, Q)表示
   「不信任 → 普通 → 信任」的線性／曲線效果。
   （2）m_clm3：採用 trust_Tsai_score（0, 1, 2 的 numeric），直接假設
  「每升一級信任」斜率固定，係數就是你說的那個 0.92（OR ≈ 2.51）。
4. pairwise comparison: 利用 Tukey 等檢測法進行成對比較，檢測變項是否出現
   Type I Error。</span>

<span class="toc-banner">目錄</span>
1.資料簡述與研究主旨
2.變項及其所在位置
3.假設
4.建立dep.variable: TW_Economy
5.重新處理 reference group
6.建立第一個模型 m_clm
7.共線性檢測 第一個模型 m_clm
8.說明 第一個模型 m_clm
9.建立第二個回歸方程式 m_clmm
10.共線性檢測第二個回歸方程式 m_clmm
11.三個變項的共線性檢測 
12.建立第三個回歸模型 m_clm3
13.比較第二個與第三個回歸模型 m_clmm Vs.m_clm3 
14.說明第三個回歸模型 m_clm3
15.預測機率 m_clm3 
16.信賴區間
17.pairwise comparison
18.兩模型比較 m_clmm Vs. m_clm3
19.建立第四個模型 m_clm4
20.存檔</span>

<span class="toc-banner">1.資料簡述與研究主旨</span>
採用資料：TEDS2024-T_PAO3.sav。
資料處理後的資料檔：C.csv; CX.csv。
研究主旨：對未來拜年的經濟預期，與對韓國瑜的好感度、
對蔡英文總統的信任程度、政黨認同傾向、國族身份認同、
居住地點、學歷與年齡等因素的關係。

<span class="toc-banner">2.變項及其所在位置</span>
       變項            變項內容            所在位置             變項類型
 1.台灣未來經濟展望  比較好 差不多 比較不好    CX$TW_Economy    ordinal/category
 2.對韓國瑜的好感度       0-10             CX$favor_Han        numeric
 3.對蔡英文的信任度  不信任 普通 信任      CX$trust_Tsai_N    ordinal/category
 4.對蔡英文的信任度      0 1 2          CX$trust_Tsai_score    numeric
 5.政黨認同        泛綠、泛藍、民眾黨、不偏   CX$partisanship_N   category
 6.國族身份認同     台灣人 雙重認同 中國人        CX$identity     category
 7.居住地點        北臺灣 中臺灣 雲嘉南 南臺灣    CX$region       category
 8.學歷           小學與未入學 中學 大專 研究所   CX#edu       ordinal/category
 9.年齡          20s,30s,40s,50s,60+        CX$age_N      ordinal/category

<span class="toc-banner">3.假設</span>
虛無假設01：韓國瑜的好感度與臺灣未來半年經濟的評估之間沒有關聯性。
對立假設01：韓國瑜的好感度與臺灣未來半年經濟的評估之間存在關聯性。
方向性預期：對韓國瑜的好感度越高，對臺灣未來半年經濟的評估傾向於悲觀。

虛無假設02：對蔡英文總統的信任度，與臺灣未來半年經濟的評估之間沒有關聯性。
對立假設02：對蔡英文總統的信任度，與臺灣未來半年經濟的評估之間存在關聯性。
方向性預期：對蔡英文總統的信任度越高，對臺灣未來半年經濟的評估傾向於樂觀。

虛無假設03：政黨認同，與台灣未來半年經濟的評估之間沒有關聯性。
對立假設03：政黨認同與與台灣未來半年經濟的評估之間存在關聯性。
方向性預期：泛綠陣營支持者對台灣未來半年經濟的評估，比泛藍陣營、
          台灣民眾黨與都不偏支持者更傾向於樂觀。

虛無假設04：國族身份認同，與臺灣未來半年經濟的評估之間沒有關聯性。
對立假設04：國族身份認同與臺灣未來半年臺灣經濟的評估之間存在關聯性。
方向性預期：臺灣人身份認同相較於雙重認同與中國人身份認同，
          對未來半年臺灣經濟的評估更傾向於樂觀。

虛無假設05：受訪者居住地點與臺灣未來半年經濟的評估之間沒有關聯性。
對立假設05：受訪者居住地點與臺灣未來半年經濟的評估之間存在關聯性。

虛無假設06：受訪者學歷，與臺灣未來半年經濟的評估之間沒有關聯性。
對立假設06：受訪者學歷，與臺灣未來半年經濟的評估之間存在關聯性。

虛無假設07：受訪者年齡組別，與臺灣未來半年經濟的評估之間沒有關聯性。
對立假設07：受訪者年齡與與臺灣未來半年經濟的評估之間存在關聯性。

注意：所有的假設應有理論層次上的預設，這是教學材料，故略。
<span class="toc-banner">4.建立dep.variable: TW_Economy</span>
<span class="ctoc-banner">C22 <- C["q22"]
frq(C22$q22)</span>
16您覺得臺灣未來半年的經濟狀況是會變好、會變不好，還是差不多? (x) <numeric> 
# total N=1202 valid N=1202 mean=9.19 sd=25.14

Value |  Label |   N | Raw % | Valid % | Cum. %
-----------------------------------------------
    1 |   變好 | 253 | 21.05 |   21.05 |  21.05
    2 | 差不多 | 561 | 46.67 |   46.67 |  67.72
    3 | 變不好 | 298 | 24.79 |   24.79 |  92.51
   95 |   拒答 |   3 |  0.25 |    0.25 |  92.76
   96 | 看情形 |  15 |  1.25 |    1.25 |  94.01
   97 | 無意見 |   6 |  0.50 |    0.50 |  94.51
   98 | 不知道 |  66 |  5.49 |    5.49 | 100.00

<span class="ctoc-banner">C22 <- C22 %>%
  mutate(TW_Economy = case_when(q22 == 1 ~ "變好",
                                q22 == 2 ~ "差不多",
                                q22 == 3 ~ "變不好",
                                TRUE     ~ NA_character_
                               )
        )</span>

<span class="ctoc-banner">C22$TW_Economy <- factor(C22$TW_Economy,
                  levels = c("變不好", "差不多", "變好"), 
                  ordered = TRUE) #refrernce  變不好</span>

<span class="ctoc-banner">CX <- cbind(CX,C22)</span>

<span class="toc-banner">5.重新處理 reference group</span>
1) 處理 CX$partisanship_N (參照組: 泛綠陣營)
<span class="ctoc-banner">CX$partisanship_N <- relevel(factor(CX$partisanship_N),
                             ref = "泛綠陣營")</span>
2) 處理 CX$identity (參照組: 臺灣人)
# 如果您不知道確切的 levels 順序，使用 relevel() 更方便
<span class="ctoc-banner">CX$identity <- relevel(factor(CX$identity),
                       ref = "臺灣人")</span>
3) 處理 CX$region (參照組: 北臺灣)
<span class="ctoc-banner">CX$region <- relevel(factor(CX$region),
                     ref = "北臺灣")</span>
4) 處理 CX$edu (參照組：大專) 改為non-ordinal
<span class="ctoc-banner">CX$edu <- factor(CX$edu,
                 levels  = c("大專", "小學與未入學", "中學", "碩博士"),
                 ordered = FALSE
                 )</span> # reference == 大專
5) 處理 CX$age_N (參照組：60+) 改為non-ordinal
<span class="ctoc-banner">CX$age_N <- relevel(factor(CX$age_N),
                     ref = "60+",
                     ordered = FALSE)</span>
注意：在進行統計建模時，除非你特別想針對某一組別做比較或解釋，刻意把它設為 
     reference，否則一般建議把樣本數最多的那一組設為參考組
     （reference category）。
     主要原因包括：
     1.估計比較穩定
       參考組本身沒有迴歸係數（它是 0），其他組的係數都是「相對於參考組」的差異。
       如果參考組樣本太少，其他組在跟它比較時，標準誤會變大、估計會比較不穩定，
       結果比較難解釋。
     2.解釋上更直覺
       把「最多人所在的那一組」當作基準，其他組的係數可以理解為：
      「跟最典型／最常見的那一群人相比，這一群人比較悲觀？比較樂觀？差多少？」
       這通常比拿一個很少見的群體當基準，更有實務意義。
     3.避免怪異的基準點
       如果把一個很小、很特殊的群體（例如極少數政黨支持者）設為 reference，
       其實會讓所有係數都變成「相對於這個小眾」的差異，
       解讀上容易讓讀者困惑：「為什麼要以這一組當標準？」
<span class="toc-banner">6.建立第一個模型 m_clm</span>
<span class="ctoc-banner">m_clm <- lm(
  as.numeric(TW_Economy) ~ favor_Han +
                           trust_Tsai_N +
                           partisanship_N +
                           identity +
                           region +
                           edu +
                           age_N,
                           data = CX
)</span>
<span class="toc-banner">7.共線性檢測 第一個模型 m_clm</span>
<span class="ctoc-banner">install.packages("performance")</span>
<span class="ctoc-banner">library(performance)</span>
<span class="ctoc-banner">check_collinearity(m_clm)</span>
Low Correlation

           Term  VIF   VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
      favor_Han 1.47 [1.37, 1.60]     1.21      0.68     [0.62, 0.73]
   trust_Tsai_N 2.26 [2.07, 2.49]     1.23      0.44     [0.40, 0.48]
 partisanship_N 2.82 [2.56, 3.12]     1.19      0.35     [0.32, 0.39]
       identity 1.54 [1.43, 1.67]     1.11      0.65     [0.60, 0.70]
         region 1.08 [1.03, 1.19]     1.01      0.93     [0.84, 0.97]
            edu 1.37 [1.28, 1.49]     1.05      0.73     [0.67, 0.78]
          age_N 1.60 [1.49, 1.75]     1.06      0.62     [0.57, 0.67]

說明 
VIF 與 adj.VIF  均 < 5。
Tolerance 皆 > 0.2， 95% CI > 0.2。
模型 m_clm 中所有自變數之間均存在極低的共線性。

<span class="toc-banner">8.說明 第一個模型 m_clm </span>
Call:
lm(formula = as.numeric(TW_Economy) ~ favor_Han + trust_Tsai_N + 
    partisanship_N + identity + region + edu + age_N, data = CX)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.45303 -0.43172 -0.06087  0.52449  1.58791 

Coefficients:
                          Estimate Std. Error t value Pr(>|t|)    
(Intercept)               2.155451   0.072150  29.875  < 2e-16 ***
favor_Han                -0.011323   0.008429  -1.343  0.17948    
trust_Tsai_N.L            0.406070   0.048358   8.397  < 2e-16 ***
trust_Tsai_N.Q            0.005640   0.036755   0.153  0.87808    
partisanship_N泛藍陣營   -0.177935   0.076052  -2.340  0.01950 *  
partisanship_N台灣民眾黨 -0.210632   0.070126  -3.004  0.00273 ** 
partisanship_N都不偏     -0.137514   0.062275  -2.208  0.02746 *  
identity中國人           -0.119438   0.155408  -0.769  0.44234    
identity雙重認同         -0.041632   0.049966  -0.833  0.40492    
region中臺灣              0.047655   0.049934   0.954  0.34013    
region南臺灣             -0.031525   0.055765  -0.565  0.57199    
region雲嘉南              0.042110   0.060544   0.696  0.48688    
edu小學與未入學          -0.083623   0.100025  -0.836  0.40334    
edu中學                  -0.055282   0.046700  -1.184  0.23679    
edu碩博士                 0.075965   0.059972   1.267  0.20557    
age_N20s                 -0.125391   0.075343  -1.664  0.09637 .  
age_N30s                 -0.120991   0.067333  -1.797  0.07265 .  
age_N40s                 -0.149646   0.060437  -2.476  0.01345 *  
age_N50s                 -0.044040   0.059780  -0.737  0.46147    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.6208 on 1015 degrees of freedom
  (168 observations deleted due to missingness)
Multiple R-squared:  0.2299,  Adjusted R-squared:  0.2163 
F-statistic: 16.84 on 18 and 1015 DF,  p-value: < 2.2e-16

說明
Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
trust_Tsai_N.L            1.300850   0.159347   8.164 3.25e-16 ***
trust_Tsai_N.Q           -0.001846   0.116957  -0.016   0.9874    

1. 將蔡英文信任度，trust_Tsai_N 採取 [不信任 普通 信任] ordinary方式進行回歸，
   在線性項目具有統計上的顯著性。因此，我們在下一個階段改採等級方式處理。
2. 在這種設定下，模型會將 trust_Tsai_N 分解為線性項（trust_Tsai_N.L）與二次項
  （trust_Tsai_N.Q）。估計結果顯示，線性項的迴歸係數顯著（β = 1.301, p < .001），
   而二次項並不顯著（β ≈ 0, p = .99），表示三個信任等級對經濟預期的影響大致呈現單調
   monotonic 且近似線性的變化，並無明顯彎曲或「中間特別不同」(Ｕor倒Ｕ)的非線性型態。
3. 調整 trust_Tsai_N 為 trust_Tsai_score，
   不信任 == 0
   普通 == 1
   信任 == 2
   在本模型 m_clm 中，「對蔡英文總統的信任度」(trust_Tsai_N）原先以順序型變項處理，
   共有三個等級：「不信任」、「普通」、「信任」。並在序列邏輯斯迴歸模型中採用預設的
   正交多項式對比（orthogonal polynomial contrasts）。
4. 此一做法等同於假設三個信任等級在潛在連續尺度上具有相同
   的間距，且信任度每提升一級（例如從「不信任」到「普通」，或從「普通」到「信任」）對
  「經濟預期較為樂觀」的效果大小相同。換言之，在新的模型中，trust_Tsai_score 的迴歸係數
   可以直接解釋為：信任度每上升一級，落在較樂觀經濟評價類別的勝算比會乘上一個固定倍數
  （OR = exp(β)），使結果的詮釋更為直觀、簡潔。

<span class="toc-banner">9.建立第二個回歸方程式 m_clmm</span>              
<span class="ctoc-banner">install.packages("ordinal")
library(ordinal)</span>
<span class="ctoc-banner">m_clmm <- clm(
  TW_Economy ~ favor_Han +
               trust_Tsai_score +
               partisanship_N +
               identity +
               region +
               edu +
               age_N,
               data   = CX,
               link = "logit"  # 指定 link = logit
              )</span>

<span class="ctoc-banner">summary(m_clmm)</span>
formula: 
TW_Economy ~ favor_Han + trust_Tsai_score + partisanship_N + identity + region + edu + age_N
data:    CX

 link  threshold nobs logLik  AIC     niter max.grad cond.H 
 logit flexible  1034 -935.39 1908.79 5(0)  3.27e-07 2.2e+03

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
favor_Han                -0.03785    0.02696  -1.404  0.16032    
trust_Tsai_score          0.91986    0.11267   8.164 3.24e-16 ***
partisanship_N泛藍陣營    -0.52765    0.24089  -2.190  0.02850 *  
partisanship_N台灣民眾黨  -0.68252    0.22248  -3.068  0.00216 ** 
partisanship_N都不偏     -0.42611    0.19170  -2.223  0.02623 *  
identity中國人           -0.50461    0.52440  -0.962  0.33592    
identity雙重認同         -0.09917    0.15940  -0.622  0.53385    
region中臺灣              0.17476    0.15733   1.111  0.26667    
region南臺灣             -0.10107    0.17558  -0.576  0.56486    
region雲嘉南              0.12461    0.19140   0.651  0.51502    
edu小學與未入學           -0.26084    0.31738  -0.822  0.41115    
edu中學                  -0.14358    0.14667  -0.979  0.32762    
edu碩博士                 0.27470    0.19177   1.432  0.15201    
age_N20s                 -0.40200    0.23886  -1.683  0.09238 .  
age_N30s                 -0.34876    0.21139  -1.650  0.09898 .  
age_N40s                 -0.46511    0.19096  -2.436  0.01486 *  
age_N50s                 -0.14171    0.18869  -0.751  0.45263    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Threshold coefficients:
              Estimate Std. Error z value
變不好|差不多  -0.9209     0.2921  -3.152
差不多|變好     1.8614     0.2973   6.262
(168 observations deleted due to missingness)
<span class="toc-banner">10.共線性檢測第二個回歸方程式 m_clmm</span>             
<span class="ctoc-banner">check_collinearity(m_clmm)</span>
Check for Multicollinearity

Low Correlation

           Term  VIF   VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
      favor_Han 3.17 [2.88, 3.52]     1.78      0.31     [0.28, 0.35]
 partisanship_N 3.47 [3.14, 3.85]     1.86      0.29     [0.26, 0.32]
       identity 1.70 [1.57, 1.86]     1.30      0.59     [0.54, 0.64]
         region 1.85 [1.70, 2.03]     1.36      0.54     [0.49, 0.59]
            edu 2.24 [2.05, 2.47]     1.50      0.45     [0.40, 0.49]
          age_N 3.85 [3.47, 4.28]     1.96      0.26     [0.23, 0.29]

Moderate Correlation

             Term  VIF   VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
 trust_Tsai_score 6.58 [5.90, 7.35]     2.56      0.15     [0.14, 0.17]

說明
上半部
VIF(Variance Inflation Factor)
這幾個 VIF 大約在 1.70～3.9 之間，沒有太大問題，不需要為了共線性把它們刪掉。
  VIF（）：
  • 1 = 完全沒有共線性
  • 1–5 = 一般都視為可接受
  • 5–10 = 中度
  • 10 = 嚴重
Tolerance
  • Tolerance = 1 / VIF
  • 越小代表越嚴重的共線性
  • 常見經驗法則：Tolerance < 0.1 才算真的很糟
  • Tolerance都在 0.26 以上，其實都還 OK。

下半部 trust_Tsai_score
VIF
  • VIF ≈ 6.6。中度共線性。
  • 顯示它跟其它解釋變數（例如 favor_Han、partisanship_N、age_N…）有蠻高的線性關聯。
  • adj. VIF = 2.56
  • performance 套件對類別變數 / 多 df 變數做了一個調整（類似 GVIF 的校正），
  • 讓不同型態的變數可以放在比較接近的尺度上。
  • 這個數值更接近「實際膨脹程度」，2.56 其實並不高。
  • Tolerance ≈ 0.15
  • 代表：trust_Tsai_score 約有 85% 的變異可以被其他自變項解釋。
  • 但仍有 15% 是「它自己獨有」的 → 還不是 0，那就不是完全冗餘。

解決方法：將三組可能的自變項近下共線性檢測。

<span class="toc-banner">11.三個變項的共線性檢測 </span>  
1)變項轉換
採用cor()函數處理。
條件是必須將變項調整為數值。
partisanship_N轉化為三個數值，1,2,3。

<span class="ctoc-banner">num_df <- CX |>
  transmute(
    trust_Tsai_score = as.numeric(trust_Tsai_score),
    favor_Han        = as.numeric(favor_Han),
    partisanship_num = as.numeric(partisanship_N)  # factor → 1, 2, 3, ...
  )</span> 

2)成對檢驗，檢測其他兩個變項與trust_Tsai_score之間的共線性
<span class="ctoc-banner">cor_mat <- cor(num_df, use = "pairwise.complete.obs", 
               method = "pearson")</span> 

看 trust_Tsai_score 跟其他變數的相關
<span class="ctoc-banner">cor_mat["trust_Tsai_score", ]</span>  

trust_Tsai_score        favor_Han partisanship_num 
       1.0000000       -0.3875135       -0.4208900 

說明
1.在進一步進行迴歸分析之前，我先檢查了自變項之間的相關程度，以評估多重共線性的風險。
  使用 Pearson 積差相關係數、並採用 pairwise.complete.obs 
  估計方式（即在各對變項之間，僅以該對變項皆不為 NA 的樣本計算相關），得到的結果如下：
2.trust_Tsai_score 與 partisanship_num（將政黨認同的類別因子粗略編碼為數值）
  之間的相關係數約為 -0.42；
  trust_Tsai_score 與 favor_Han（對韓國瑜的好感度）之間的相關係數約為 -0.39。
3.從數值上來看，這兩組相關都落在 0.4左右的區間，通常可視為「中度相關」，
  但仍明顯低於實務上常用來判定嚴重共線性的門檻（例如 |r| ≥ 0.7 以上才會被視為高度共線）。
  換言之，trust_Tsai_score 與政黨認同、韓國瑜好感之間確實存在實質關聯，
  符合政治態度在實務上常常高度聚合的直覺；
  然而，這種相關程度雖然會提高迴歸係數的標準誤，使估計略為保守，
  但尚不足以構成「無法估計」或「結果完全不可靠」的嚴重多重共線性。
4.因此，在後續模型中，一方面保留理論上重要的變項（如政黨認同、對蔡英文的信任），
  但remove favor_Han，另一方面則透過檢視 VIF 值及估計結果的穩定性，
  來確認這樣的中度共線性仍在可接受範圍內，而無須因為相關達到 0.4
  左右就任意刪除關鍵解釋變數。

<span class="toc-banner">12.建立第三個回歸模型 m_clm3 </span>

這個模型 m_clm3 係移除 favor_Han, 保留 partisanship_N 與 trust_Tsai_score
進行回歸分析。

<span class="ctoc-banner">m_clm3 <- clm(
  TW_Economy ~ trust_Tsai_score  +
               partisanship_N+
               identity +
               region +
               edu +
               age_N,
               data   = CX,
               link = "logit"  # 指定 link = logit
              )</span>
<span class="ctoc-banner">summary(m_clm3)</span>
formula: 
TW_Economy ~ trust_Tsai_score + partisanship_N + identity + region + edu + age_N
data:    CX

 link  threshold nobs logLik  AIC     niter max.grad cond.H 
 logit flexible  1043 -943.05 1922.10 5(0)  3.88e-07 2.2e+02

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
trust_Tsai_score           0.9313     0.1123   8.290  < 2e-16 ***
partisanship_N泛藍陣營    -0.6118     0.2305  -2.654 0.007954 ** 
partisanship_N台灣民眾黨  -0.7283     0.2198  -3.314 0.000921 ***
partisanship_N都不偏      -0.4706     0.1886  -2.496 0.012574 *  
identity中國人            -0.4805     0.5004  -0.960 0.336863    
identity雙重認同          -0.1638     0.1553  -1.055 0.291466    
region中臺灣               0.1469     0.1565   0.939 0.347977    
region南臺灣              -0.1016     0.1748  -0.581 0.561140    
region雲嘉南               0.1163     0.1898   0.613 0.539964    
edu小學與未入學           -0.2145     0.3129  -0.685 0.493111    
edu中學                   -0.1584     0.1458  -1.087 0.277035    
edu碩博士                  0.2770     0.1917   1.445 0.148513    
age_N20s                  -0.3619     0.2364  -1.531 0.125768    
age_N30s                  -0.3012     0.2093  -1.439 0.150037    
age_N40s                  -0.4315     0.1894  -2.278 0.022748 *  
age_N50s                  -0.1186     0.1881  -0.631 0.528298    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Threshold coefficients:
              Estimate Std. Error z value
變不好|差不多  -0.7820     0.2743  -2.851
差不多|變好     2.0127     0.2811   7.161
(159 observations deleted due to missingness)

<span class="toc-banner">13.比較第二個與第三個回歸模型 m_clmm Vs.m_clm3 </span>
Model: m_clmm
Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
favor_Han                -0.03785    0.02696  -1.404  0.16032    
trust_Tsai_score          0.91986    0.11267   8.164 3.24e-16 ***
partisanship_N泛藍陣營   -0.52765    0.24089  -2.190  0.02850 *  
partisanship_N台灣民眾黨 -0.68252    0.22248  -3.068  0.00216 ** 
partisanship_N都不偏     -0.42611    0.19170  -2.223  0.02623 *  


Model: m_clm3
Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
trust_Tsai_score           0.9313     0.1123   8.290  < 2e-16 ***
partisanship_N泛藍陣營    -0.6118     0.2305  -2.654 0.007954 ** 
partisanship_N台灣民眾黨  -0.7283     0.2198  -3.314 0.000921 ***
partisanship_N都不偏      -0.4706     0.1886  -2.496 0.012574 * 

移除favor_Han之後，trust_Tsai_score的相關數值並未出現大幅波動。說明：
1.從比較 m_clmm（含 favor_Han）與 m_clm3（移除 favor_Han）可以看到，
  trust_Tsai_score 的估計相當穩定：係數由 0.920（SE = 0.113）
  微幅上升為 0.931（SE = 0.112），
  z 值由 8.16 增為 8.29，皆高度顯著（p < .001）。
  也就是說，無論是否同時控制對韓國瑜的好感，對蔡英文的信任都持續展現強烈且穩定的正向效果，
  顯示其解釋力並非來自模型規格的偶然產物，而是對台灣經濟評價的關鍵預測因子。

2.同時，移除 favor_Han 後，三個政黨虛擬變數（泛藍、民眾黨、都不偏）的負向係數絕對值
  略為放大（例如泛藍由 -0.53 降至 -0.61），但方向與顯著性並未改變。
  這代表 favor_Han 與政黨、蔡英文信任之間確實有部分重疊，但其額外提供的解釋力有限；
  在不包含 favor_Han 的情況下，政黨立場與領袖信任的主要結論依然完整保留。

3.綜合而言，移除 favor_Han 並未削弱 trust_Tsai_score 
  的解釋力，也未改變政黨變數的實質含義；反之， m_clm3在不犧牲關鍵資訊的前提下，
  提供了一個更為精簡、易於詮釋的模型。因此，後續分析以 m_clm3 作為主要規格，
  並將 m_clmm 視為檢驗結果穩健性的替代模型。

<span class="toc-banner">14.說明第三個回歸模型 m_clm3 </span>
說明
A. 對蔡英文的信任（trust_Tsai_score）
  • 係數：0.9313，SE = 0.1123，z = 8.29，p < 0.001
  • 解讀：
在控制政黨、國族認同、區域、教育與年齡之後，
越信任蔡英文的受訪者，越傾向認為「台灣經濟變好」（相對於「差不多／變不好」）。
  • 粗略來說，每增加 1 單位的 trust_Tsai_score，往較佳經濟評價方向移動的勝算比約增加 
    exp(0.93) = 2.535 倍。

也就是說，信任蔡英文是「看好台灣經濟」的關鍵預測因子，效果強且穩定。

說明
在 ordinal logit（累積勝算模型） 裡，這個 β_trust 代表的是：

在其他變數都固定不變的情況下，trust_Tsai_score 每增加 1 級，
受訪者「經濟評價落在比較樂觀的等級」的 log-odds 會增加 0.93。。

把 log-odds 轉成 勝算比（odds ratio, OR）：

OR= exp(0.9313174) ≈ 2.537

也就是說：
信任度每多一個層級（不信任→普通, 普通→信任），覺得「未來半年經濟會比較好」的勝算，大約乘上 2.54 倍。
多兩個層級，就是 2.537^2 ≈ 6.44，覺得「未來半年經濟會比較好」的勝算，大約乘上 6.44倍。


<span class="btoc-banner">🎈情境 1: 不信任蔡英文 (trust = 0)
計算「變不好 vs (差不多或變好)」的勝算:
假設 α₁ = 1.5
odds_0 = exp(1.5 - 0.93 × 0) = exp(1.5) = 4.48

解釋
不信任蔡英文者中,經濟「變不好」Vs.「差不多或變好」= 4.48 : 1
4.48 個人覺得變不好 Vs. 1 個人覺得不會變不好

情境 2: 普通信任 (trust = 1)
odds_1 = exp(1.5 - 0.93 × 1) = exp(0.57) = 1.77

# 勝算比
OR = odds_1 / odds_0 = 1.77 / 4.48 = 0.395
# 或直接: exp(-0.93) = 0.395
解釋
對蔡英文「普通信任者」中，認為台灣經濟變不好 Vs.「差不多或變好」 = 0.395: 1
0.395 個人覺得變不好 Vs. 1 個人覺得不會變不好。

# 反過來看「更樂觀」的勝算:
1 / 0.395 = 2.537 
1 個人覺得變不好 Vs. 2.537 個人覺得不會變不好。

情境 3: 信任蔡英文 (trust = 2)
rodds_2 = exp(1.5 - 0.93 × 2) = exp(-0.36) = 0.70

# 相對於不信任者 (trust = 0)
OR = odds_2 / odds_0 = 0.70 / 4.48 = 0.156
解釋
對蔡英文「信任者」中，認為台灣經濟變不好 Vs.「差不多或變好」 = 0.156: 1
0.156 個人覺得變不好 Vs. 1 個人覺得不會變不好。

# 反過來看:
1 / 0.156 = 6.41 ≈ 2.537^2 ✓
1 個人覺得變不好 Vs. 6.41 個人覺得不會變不好。

說明
在本模型中，若以「變不好」相對於「差不多或變好」作為參考，
trust_Tsai_score 的迴歸係數約為 −0.93。這表示在其他變項固定下，
信任程度每增加一級，「認為經濟會變不好」的勝算約乘上 exp(−0.93) ≈ 0.40 倍，
換句話說，「變不好」變得不那麼可能。反過來看「不覺得變不好」（即「差不多或變好」）那一側，
對應的勝算比為 1/0.40 ≈ 2.54，也就是說信任程度每增加一級，
「不覺得經濟會變不好」的勝算約為原來的 2.54 倍。
若從「不信任」提升兩級到「信任」，則對應的勝算比約為 (2.54)² ≈ 6.4，
即在控制其他條件下，「信任」蔡英文的受訪者，其不認為經濟會變壞的勝算約為「不信任」者的 6 倍以上。</span>

總結
在控制政黨認同、國族認同、地區、教育與年齡等變項後，
trust_Tsai_score 的迴歸係數為 0.9313，p < 0.01。
在傳統的 5% 顯著水準下，我們可以拒絕
「對蔡英文的信任度與未來半年經濟評估之間沒有關聯性」這一虛無假設02，
換言之，本研究發現：對蔡英文越信任的受訪者，越有可能對未來半年台灣經濟持較樂觀評價。

B.政黨認同（partisanship_N）
基準組：泛綠陣營
相對於泛綠，其他三類政黨支持者都較不看好台灣經濟：
1. 泛藍陣營
  • 係數 = -0.6118，p ≈ 0.008
  exp(-0.6118) =  0.5423737
  泛藍支持者 顯著較不容易認為經濟變好。
2. 台灣民眾黨
  • 係數 = -0.7283，p ≈ 0.001
  exp(-0.7283) = 0.4827289
  台灣民眾黨支持者 顯著較不容易認為經濟變好。
  民眾黨支持者也顯著更悲觀，甚至比泛藍略為悲觀。
3. 都不偏
  • 係數 = -0.4706，p ≈ 0.013
  exp(-0.4706) = 0.6246274
  自認「都不偏」者，同樣比泛綠支持者更不看好經濟。

C.政黨認同（partisanship_N）
以泛綠陣營為基準組，相對於泛綠，其他三類政黨支持者整體上都較不看好台灣經濟。
泛藍支持者的迴歸係數為 −0.6118（p ≈ 0.008），其勝算比為 exp(−0.6118) ≈ 0.54，表示在其他條件相同下，泛藍支持者認為未來半年經濟「會變好」的勝算，約為泛綠支持者的 0.54 倍。台灣民眾黨支持者的係數為 −0.7283（p ≈ 0.001），勝算比約 0.48，顯示其經濟期待顯著偏向悲觀，甚至略低於泛藍支持者。自認「都不偏」者的係數為 −0.4706（p ≈ 0.013），勝算比約 0.62，同樣比泛綠支持者更不看好經濟。
小結
1.在控制對蔡英文的信任度、國族身份認同、居住地點、年齡與學歷等變項後，
  政黨認同仍然對民眾的經濟評價具有顯著影響。在傳統的 5% 顯著水準下，我們可以拒絕
 「政黨認同，與台灣未來半年經濟的評估之間沒有關聯性」這一虛無假設03，

2.相較於泛綠陣營支持者，泛藍陣營支持者、台灣民眾黨支持者與自認「都不偏」的受訪者，
  其認為未來半年經濟狀況會「變好」——不論是在「會變好」相較於「變不好＋差不多」，
  或「差不多＋會變好」相較於「變不好」這兩種序位切割方式下——
  其勝算比分別約為 0.54 倍、0.48 倍與 0.62 倍。
3.換言之，即便在排除其他社會背景與信任變項的影響之後，與泛綠支持者相比，
  泛藍與台灣民眾黨支持者，以及自認「都不偏」的受訪民眾，
  在主觀上都顯著較不傾向認為未來半年台灣經濟會「變好」，
  顯示在本樣本中，經濟評價依然深受政黨光譜的結構化影響。

D.年齡（age_N）
參考組：大多是 60+（未列出的那一組）
  • 20s、30s：係數約 -0.36、-0.30，p ≈ 0.12–0.15（接近但未達 0.05）
  • 40s：係數 = -0.4315，p ≈ 0.023（顯著）
               exp(-0.4315) = 0.6495341
  • 50s：不顯著
結論
1.在控制對蔡英文的信任度、國族身份認同、政黨認同、居住地點、年齡與學歷等變項後，
  年齡組別仍然對民眾對未來半年經濟評價具有顯著影響。拒絕虛無假設7：
  受訪者年齡組別，與臺灣未來半年經濟的評估之間沒有關聯性。
2.相較60+， 40s的受訪民眾，其認為未來半年經濟狀況會變得比較好——也就是在
  「會變好」相較於「變不好＋差不多」，以及「差不多＋會變好」相較於「變不好」
  這兩種區分下——的勝算比分別約為 0.65倍。（estimate = -0.4315, p = 0.023 ），相較於60+的群體，40s 較不看好台灣未來半年的經濟發展前景。
  其它年齡組別則不具統計上的顯著性。
3.根據上述結果，至少就「40 多歲相較於 60 歲以上」這一組比較而言，我們可以在 5% 顯
  著水準下拒絕這一部分的虛無假設。也就是說，年齡在本模型中並非完全無關，而是主要透過 40 多歲族群相對於 60+ 的明顯悲觀態度表現出來；至於其他年齡層，則尚不足以斷言與 60+ 有系統性差異。
4.上述關於年齡效果的判讀，應視為暫定結論。進一步在 17. pairwise comparison 中，
  我們利用 emmeans 進行成對比較，並採用 Tukey 式多重比較校正，以較為保守的標準
  同時檢定各年齡組別之間的差異。結果顯示：雖然在原始回歸係數中，40 歲族群相較於
  60歲以上達到 5% 顯著水準，但在經過多重比較修正後，其成對比較的調整後
  p 值已不再顯著。這意味著，年齡變項在本模型中所呈現的顯著效果，
  可能部分反映了一類錯誤（Type I error）的風險；換言之，
  我們較難自信地宣稱「40 歲族群一定比 60+ 顯著悲觀」，而更宜將之視為一個有趣但尚待後續研究驗證的趨勢。

E.identity（中國人、雙重認同, reference == 臺灣人）、
  region（中臺灣、南臺灣、雲嘉南, reference == 北臺灣）、
  edu（小學、中學、碩博, reference == 大專）
  → 係數方向有高低，但 都未達統計顯著。
結論
  在控制對蔡英文的信任度、國族身份認同、政黨認同、居住地點、年齡與學歷等變項後，
  國族身份認同組別、居住地點與受訪者教育程度仍然對民眾對未來半年經濟評價具有顯著影響。
  拒絕虛無假設04：
  國族身份認同與臺灣未來半年經濟的評估之間沒有關聯性。
  拒絕虛無假設05：
  受訪者居住地點與臺灣未來半年經濟的評估之間沒有關聯性。
  拒絕虛無假設06：
  受訪者學歷，與臺灣未來半年經濟的評估之間沒有關聯性。
<span class="toc-banner">15.預測機率 m_clm3 </span>
<span class="ctoc-banner">library(dplyr)
library(ordinal)   # clm()
library(tidyr)</span>

1) 預測機率的意義
       一位 60+、大專學歷、泛綠、臺灣人、北臺灣、
       在「不信任 / 普通 / 信任」蔡英文的情況下，
       各自有多少機率覺得「未來半年經濟變不好 / 差不多 / 變好」。

2)先準備「信任程度」對應的代表性 trust_Tsai_score
<span class="ctoc-banner">trust_lookup <- CX %>%
  group_by(trust_Tsai_score) %>%
  summarise(trust_Tsai_score = mean(trust_Tsai_score, na.rm = TRUE))</span>
<span class="ctoc-banner">trust_lookup</span>
# A tibble: 4 × 1
  trust_Tsai_score
             <dbl>
1                0
2                1
3                2
4              NaN

3)建立要預測的三種情境
<span class="ctoc-banner">grid <- tibble::tibble(
  trust_Tsai_score = c(0, 5, 10),   # 一定要 numeric，因為模型是用數值
  partisanship_N   = factor("泛綠陣營", levels = levels(CX$partisanship_N)),
  identity         = factor("臺灣人",   levels = levels(CX$identity)),
  region           = factor("北臺灣",   levels = levels(CX$region)),
  edu              = factor("大專",     levels = levels(CX$edu)),
  age_N            = factor("60+",      levels = levels(CX$age_N))
)</span>

說明
在原先的測量中，對蔡總統的信任指數，即是從 0-10的量表。因此，將信任層級轉化為數值時，
轉化為c(0,5,10)，相較於c(0,1,2)，會更貼近原先的Likert量表。
<span class="ctoc-banner">grid</span>
# A tibble: 3 × 6
  trust_Tsai_score partisanship_N identity region edu   age_N
             <dbl> <fct>          <fct>    <fct>  <fct> <fct>
1                0 泛綠陣營       臺灣人   北臺灣 大專  60+  
2                5 泛綠陣營       臺灣人   北臺灣 大專  60+  
3               10 泛綠陣營       臺灣人   北臺灣 大專  60+  

4)用主模型 m_clm3 算預測機率
<span class="ctoc-banner">pred <- predict(m_clm3, 
                                          newdata = grid,
                                          type = "prob")</span>
<span class="ctoc-banner">pred</span>
$fit
        變不好      差不多      變好
1 3.138905e-01 0.568234511 0.1178750
2 4.326845e-03 0.062040480 0.9336327
3 4.127685e-05 0.000633492 0.9993252
------------------
離題一下
轉化為非科學記號（R版）
1.全域關掉科學記號（方便、最常用）
<span class="ctoc-banner">options(scipen = 999)</span>
2.直接四捨五入到想要的[第三位]小數位
<span class="ctoc-banner">probs_round <- round(pred$fit, 3)</span>
<span class="ctoc-banner">probs_round</span>
  變不好 差不多  變好
1  0.314  0.568 0.118
2  0.004  0.062 0.934
3  0.000  0.001 0.999
------------------ 
<span class="ctoc-banner">probs <- as.data.frame(pred)</span>
<span class="ctoc-banner">probs <- cbind(scenario = c("不信任", "普通", "信任"),
  probs)</span>
<span class="ctoc-banner">probs</span>

  scenario   fit.變不好  fit.差不多  fit.變好
1   不信任 3.138905e-01 0.568234511 0.1178750
2     普通 4.326845e-03 0.062040480 0.9336327
3     信任 4.127685e-05 0.000633492 0.9993252

轉化科學符號(LLM比較快！)
  scenario   fit.變不好  fit.差不多  fit.變好
1   不信任       0.314     0.568     0.118
2     普通       0.004     0.062     0.934
3     信任     0.00004  0.000633     0.999

5)四捨五入到小數點第三位
1. 把預測機率矩陣取出來，變成 data.frame
<span class="ctoc-banner">prob_df <- as.data.frame(pred$fit)</span>
2. 加上「信任程度」這一欄（0,1,2 或 不信任/普通/信任）
<span class="ctoc-banner">prob_df</span>
        變不好      差不多      變好
1 3.138905e-01 0.568234511 0.1178750
2 4.326845e-03 0.062040480 0.9336327
3 4.127685e-05 0.000633492 0.9993252
<span class="ctoc-banner">prob_tbl <- cbind(
  信任程度 = factor(c("不信任", "普通", "信任"),
                    levels = c("不信任", "普通", "信任")),
  prob_df
)</span>
<span class="ctoc-banner">prob_tbl</span>
  信任程度       變不好      差不多      變好
1   不信任 3.138905e-01 0.568234511 0.1178750
2     普通 4.326845e-03 0.062040480 0.9336327
3     信任 4.127685e-05 0.000633492 0.9993252

3. 變成 tibble，數字四捨五入到小數點第三位
<span class="ctoc-banner">prob_tbl <- prob_tbl %>%
  as_tibble() %>%
  mutate(across(where(is.numeric), ~ round(.x, 3)))</span>
<span class="ctoc-banner">prob_tbl</span>
# A tibble: 3 × 4
  信任程度 變不好 差不多  變好
  <fct>     <dbl>  <dbl> <dbl>
1 不信任    0.314  0.568 0.118
2 普通      0.004  0.062 0.934
3 信任      0      0.001 0.999

5)視覺化
轉化為長表
<span class="ctoc-banner">prob_long <- prob_tbl %>%
  pivot_longer(
    cols = c("變不好", "差不多", "變好"),
    names_to = "TW_Economy",
    values_to = "prob"
  )</span>
<span class="ctoc-banner">prob_long</span>
# A tibble: 9 × 3
  信任程度 TW_Economy  prob
  <fct>    <chr>      <dbl>
1 不信任   變不好     0.314
2 不信任   差不多     0.568
3 不信任   變好       0.118
4 普通     變不好     0.004
5 普通     差不多     0.062
6 普通     變好       0.934
7 信任     變不好     0    
8 信任     差不多     0.001
9 信任     變好       0.999

<span class="ctoc-banner">library(ggplot2)
library(scales)</span>
<span class="ctoc-banner">p_信任蔡經濟 <- ggplot(prob_long,
       aes(x = 信任程度,
           y = prob,
           group = TW_Economy,
           color = TW_Economy)) +
  geom_point(size = 3) +
  geom_line() +
  # 在點的右側加上百分比數值
  geom_text(aes(label = percent(prob, accuracy = 0.1)),
            position = position_nudge(x = 0.1),  # 往右推一點
            hjust = 0,                           # 文字左對齊（看起來在點右邊）
            size = 5,
            show.legend = FALSE) +               # 不要把文字也畫在圖例裡
  scale_y_continuous(labels = percent_format(accuracy = 1)) +
  scale_x_discrete(expand = expansion(mult = c(0.05, 0.25))) + # 右邊多留一點空間
  labs(
    x = "對蔡英文的信任程度",
    y = "預測機率（%）",
    color = "未來半年經濟評價",
    title = "不同信任程度下的經濟預期（ordinal logit 預測機率）"
  ) +
  theme_minimal(base_size = 14)</span>

<span class="ctoc-banner">ggsave("p_信任蔡經濟.png", p_信任蔡經濟, 
       width = 12, height = 8, dpi = 300, bg = "white") </span>
                               # bg == background color
<span class="ctoc-banner">p_信任蔡經濟</span>

<span class="toc-banner">16.信賴區間 </span>
1) 先計算 trust_Tsai_score 的係數 β
<span class="ctoc-banner">beta_trust <- coef(m_clm3)["trust_Tsai_score"]</span> # estimate == 1.300850
<span class="ctoc-banner">beta_trust</span>
# 0.9313174 
2) 再抓出信賴區間（在 β 空間）
<span class="ctoc-banner">ci <- confint(m_clmm)</span>
<span class="ctoc-banner">ci</span>
                               2.5 %      97.5 %
trust_Tsai_score          0.71257224  1.15313251
partisanship_N泛藍陣營   -1.06468628 -0.16062407
partisanship_N台灣民眾黨 -1.16042398 -0.29841685
partisanship_N都不偏     -0.84154494 -0.10192153
identity中國人           -1.49900209  0.48288767
identity雙重認同         -0.46849048  0.14047675
region中臺灣             -0.15988237  0.45383537
region南臺灣             -0.44509660  0.24071508
region雲嘉南             -0.25594454  0.48871958
edu小學與未入學          -0.82957017  0.39887566
edu中學                  -0.44465360  0.12697984
edu碩博士                -0.09883359  0.65339420
age_N20s                 -0.82631772  0.10088733
age_N30s                 -0.71229486  0.10850097
age_N40s                 -0.80376565 -0.06085427
age_N50s                 -0.48770269  0.24987032

說明
1. 以政黨認同為例
三組的 95% CI 都是 全負值（完全小於 0）：
  • 泛藍：OR 介於 exp(−1.0647) ≈ 0.34 到 exp(−0.1606) ≈ 0.85
  • 民眾黨：OR 約 0.31～0.74
  • 都不偏：OR 約 0.43～0.90

👉 解讀：在控制信任蔡英文、國族認同、地區、教育、年齡後，
相較於泛綠支持者，
泛藍、民眾黨與「都不偏」受訪者，對經濟的看法都顯著比較悲觀——
他們認為「經濟會變好」的勝算，大約只有泛綠的三成到九成不等。

2. 以學歷＆年齡組別為例
  • 這幾個 CI 也都「跨 0」。
  • 在控制其他變項後，地區與教育程度對「未來半年經濟評價」的線性效果，
    在統計上沒有顯著證據（可能有趨勢，但不夠穩定）。

<span class="toc-banner">17.Pairwise Comparison </span>
年齡組別真的有差別嗎？
利用 tukey 等各種檢定法，進行成對檢定。
# 1) 先抓每個年齡組的平均效果（在 latent / logit 尺度上）
<span class="ctoc-banner">emm_age_latent <- emmeans(m_clm3, ~ age_N)</span>  
 # 不要 type = "response"
<span class="ctoc-banner">emm_age_latent</span>
age_N emmean    SE  df asymp.LCL asymp.UCL
 60+   -0.129 0.199 Inf    -0.520    0.2620
 20s   -0.491 0.265 Inf    -1.010    0.0282
 30s   -0.430 0.240 Inf    -0.900    0.0397
 40s   -0.560 0.222 Inf    -0.995   -0.1256
 50s   -0.247 0.229 Inf    -0.696    0.2014

Results are averaged over the levels of: partisanship_N, identity, region, edu 
Confidence level used: 0.95 

2)pairwise comparison
<span class="ctoc-banner">pairs_age <- pairs(emm_age_latent, adjust = "tukey")
summary(pairs_age)</span>
 contrast    estimate    SE  df z.ratio p.value
 (60+) - 20s   0.3619 0.236 Inf   1.531  0.5422
 (60+) - 30s   0.3012 0.209 Inf   1.439  0.6021
 (60+) - 40s   0.4315 0.189 Inf   2.278  0.1521
 (60+) - 50s   0.1186 0.188 Inf   0.631  0.9702
 20s - 30s    -0.0607 0.229 Inf  -0.265  0.9989
 20s - 40s     0.0695 0.222 Inf   0.314  0.9979
 20s - 50s    -0.2433 0.235 Inf  -1.034  0.8395
 30s - 40s     0.1302 0.194 Inf   0.670  0.9628
 30s - 50s    -0.1826 0.208 Inf  -0.878  0.9051
 40s - 50s    -0.3129 0.191 Inf  -1.637  0.4735

Results are averaged over the levels of: partisanship_N, identity, region, edu 
P value adjustment: tukey method for comparing a family of 5 estimates 

3) 轉換為勝算比OR
<span class="ctoc-banner">pairs_age_tbl <- as.data.frame(summary(pairs_age)) |>
  dplyr::mutate(
    OR = exp(estimate)
  )</span>
<span class="ctoc-banner">pairs_age_tbl</span>
      contrast    estimate        SE  df    z.ratio   p.value        OR
1  (60+) - 20s  0.36192765 0.2363984 Inf  1.5310069 0.5421693 1.4360950
2  (60+) - 30s  0.30123603 0.2092789 Inf  1.4393998 0.6020649 1.3515283
3  (60+) - 40s  0.43145038 0.1894292 Inf  2.2776345 0.1520930 1.5394887
4  (60+) - 50s  0.11859412 0.1880638 Inf  0.6306057 0.9701601 1.1259128
5    20s - 30s -0.06069161 0.2291879 Inf -0.2648116 0.9989217 0.9411134
6    20s - 40s  0.06952273 0.2216796 Inf  0.3136180 0.9979062 1.0719964
7    20s - 50s -0.24333353 0.2352495 Inf -1.0343638 0.8394747 0.7840100
8    30s - 40s  0.13021435 0.1942536 Inf  0.6703317 0.9627800 1.1390725
9    30s - 50s -0.18264192 0.2080197 Inf -0.8780032 0.9050819 0.8330664
10   40s - 50s -0.31285626 0.1911073 Inf -1.6370715 0.4735297 0.7313550

4) 比較
• (60+) - 40s = 用「60+」的平均效果減去「40s」的平均效果。
正號 → 60+ 比 40s 更樂觀（在潛在量尺 / logit 上）。
• estimate
0.4315 是兩組之間「累積 log-odds 差」
（即 log(OR)）。
• OR
OR = exp(0.43145038) = 1.539489
＝ 在控制其他變項後，60+ 的「經濟比較樂觀」的累積勝算
大約是 20s 的 1.54 倍。
這裡的「比較樂觀」指的就是 ordinal logit 的「累積」：
  • 「差不多或變好」相對於「變不好」
  • 以及「變好」相對於「差不多或變不好」
都一起被這個 OR 描述。

• SE / z.ratio / p.value
• z.ratio = estimate / SE
• p.value 是在做 Tukey 多重比較校正之後 的 p 值
（控制整體第一類錯誤率）。

總結
在控制政黨認同、國族認同、區域、教育程度之後，
不同年齡層在未來半年經濟評價上並未呈現明確的顯著差異。
以 60+ 為參照組，20s – 50s 各年齡層的累積勝算比大致介於 0.73 至 1.43 之間，
其中 40s 相對較為悲觀，但在進行 Tukey 成對比較校正後，其與 60+ 的差異
僅接近顯著（OR = 0.63 的反向、調整後 p ≈ .152)。
受訪者年齡組別，與臺灣未來半年經濟的評估之間沒有關聯性。接受虛無假設07。

5)同場加映
除了Tukey以外，還有 holm 與 fdr 等兩種較為寬鬆的兩種檢定法
holm檢定
<span class="ctoc-banner">pairs_age_holm <- summary(pairs_age, adjust = "holm")</span>
<span class="ctoc-banner">pairs_age_holm</span>
 contrast    estimate    SE  df z.ratio p.value
 (60+) - 20s   0.3619 0.236 Inf   1.531  1.0000
 (60+) - 30s   0.3012 0.209 Inf   1.439  1.0000
 (60+) - 40s   0.4315 0.189 Inf   2.278  0.2275
 (60+) - 50s   0.1186 0.188 Inf   0.631  1.0000
 20s - 30s    -0.0607 0.229 Inf  -0.265  1.0000
 20s - 40s     0.0695 0.222 Inf   0.314  1.0000
 20s - 50s    -0.2433 0.235 Inf  -1.034  1.0000
 30s - 40s     0.1302 0.194 Inf   0.670  1.0000
 30s - 50s    -0.1826 0.208 Inf  -0.878  1.0000
 40s - 50s    -0.3129 0.191 Inf  -1.637  0.9145

Results are averaged over the levels of: partisanship_N, identity, region, edu 
P value adjustment: holm method for 10 tests 

fdr檢定
<span class="ctoc-banner">pairs_age_fdr  <- summary(pairs_age, adjust = "fdr")</span>
<span class="ctoc-banner">pairs_age_fdr</span>
 contrast    estimate    SE  df z.ratio p.value
 (60+) - 20s   0.3619 0.236 Inf   1.531  0.3751
 (60+) - 30s   0.3012 0.209 Inf   1.439  0.3751
 (60+) - 40s   0.4315 0.189 Inf   2.278  0.2275
 (60+) - 50s   0.1186 0.188 Inf   0.631  0.6604
 20s - 30s    -0.0607 0.229 Inf  -0.265  0.7912
 20s - 40s     0.0695 0.222 Inf   0.314  0.7912
 20s - 50s    -0.2433 0.235 Inf  -1.034  0.6019
 30s - 40s     0.1302 0.194 Inf   0.670  0.6604
 30s - 50s    -0.1826 0.208 Inf  -0.878  0.6332
 40s - 50s    -0.3129 0.191 Inf  -1.637  0.3751

Results are averaged over the levels of: partisanship_N, identity, region, edu 
P value adjustment: fdr method for 10 tests 

<span class="toc-banner">18.兩模型比較 m_clmm Vs. m_clm3</span>
m_clmm
link  threshold nobs logLik  AIC     niter max.grad cond.H
logit flexible  1034 -935.39 1908.79 5(0)  3.27e-07 2.2e+03

m_clm3
link  threshold nobs logLik  AIC     niter max.grad cond.H 
logit flexible  1043 -943.05 1922.10 5(0)  3.88e-07 2.2e+02

•link: logit
兩個模型都是用 logit 連結 → 同一種 ordinal logit 模型。
  
•threshold: flexible
cutpoints（變不好|差不多、差不多|變好）都用「flexible」估計 → 不是固定等距，而是讓資料決定分界位置。
  
•nobs: 
有效樣本數。
  
•logLik: -935.39（Loglikelihood）
衡量模型對資料的擬合程度，數值越大(越接近 0)代表模型越好。

•AIC:m_clmm =  1908.79；m_clm3 = 1922.10
N不相同，比較缺乏意義。

•niter: 5(0)
都是 5 次迭代收斂 → 演算法穩定。

•max.grad：~3e-07
最大梯度非常小 → 收斂得還不錯。

•cond.H：
Model m_clmm: 2.2e+03(2200)
Model m_clm3: 2.2e+02(220)

Hessian 的條件數（condition number）
Hessian 矩陣的條件數
衡量參數估計的數值穩定性

cond.H        意義
1000✅        良好
1000-10000⚠️  注意共線性
> 10000❌     嚴重共線性或數值問題
結果
1.在未刪除 favor_Han時的Model m_clmm → 2200, 有些共線性的問題。  
2.在刪除 favor_Han時的Model m_clm3 → 220, 良好。

Model m_clmm: 2.2e+03(2200)
Model m_clm3: 2.2e+02(220)


<span class="toc-banner">19. 建立第四個模型 m_clm4</span>
<span class="ctoc-banner">m_clm4 <- clm(
    TW_Economy ~ favor_Han +
        partisanship_N +
        identity +
        region +
        edu +
        age_N,
    data   = CX,
    link = "logit" )</span>

<span class="ctoc-banner">summary(m_clm4)</span>
formula: TW_Economy ~ favor_Han + partisanship_N + identity + region + edu + age_N
data:    CX

 link  threshold nobs logLik  AIC     niter max.grad cond.H 
 logit flexible  1040 -980.48 1996.96 5(0)  2.26e-08 2.1e+03

Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
favor_Han                -0.045588   0.026490  -1.721   0.0853 .  
partisanship_N泛藍陣營   -1.467676   0.207849  -7.061 1.65e-12 ***
partisanship_N台灣民眾黨 -1.460417   0.198111  -7.372 1.68e-13 ***
partisanship_N都不偏     -0.960744   0.176996  -5.428 5.70e-08 ***
identity中國人           -0.945660   0.514224  -1.839   0.0659 .  
identity雙重認同         -0.328106   0.154460  -2.124   0.0337 *  
region中臺灣              0.153082   0.154530   0.991   0.3219    
region南臺灣              0.001147   0.172000   0.007   0.9947    
region雲嘉南              0.193775   0.188412   1.028   0.3037    
edu小學與未入學          -0.013989   0.310755  -0.045   0.9641    
edu中學                  -0.132744   0.144183  -0.921   0.3572    
edu碩博士                 0.340869   0.189761   1.796   0.0724 .  
age_N20s                 -0.427754   0.235167  -1.819   0.0689 .  
age_N30s                 -0.415281   0.208999  -1.987   0.0469 *  
age_N40s                 -0.465204   0.187708  -2.478   0.0132 *  
age_N50s                 -0.171283   0.185665  -0.923   0.3562    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Threshold coefficients:
              Estimate Std. Error z value
變不好|差不多  -2.4994     0.2189 -11.418
差不多|變好     0.1057     0.2000   0.528
(162 observations deleted due to missingness)

說明
1. 本模型為補充說明。
2. 條件：remove trust_Tsai_score，重新加入 favor_Han。
3. 解說
Coefficients:
                          Estimate Std. Error z value Pr(>|z|)    
favor_Han                -0.045588   0.026490  -1.721   0.0853 . 

本模型作為補充說明，在控制政黨認同、國族認同、地區、教育與年齡等變項、
並移除 trust_Tsai_score、改以 favor_Han 入模的條件下，
favor_Han 的迴歸係數為 −0.046，p ≈ 0.085。在傳統的 5% 顯著水準下，
我們無法拒絕「韓國瑜好感度與未來半年經濟評估之間無線性關係」的虛無假設，
換言之，本模型並未提供足夠證據顯示韓國瑜好感度對經濟期待有明確影響。
若採較寬鬆的 10% 顯著標準，則可視為呈現一個「趨近顯著的負向關係」，
但其效果大小與不確定性仍需謹慎解讀。
<span class="toc-banner">20. 存檔</span>
<span class="ctoc-banner">write.csv(CX,"CX.csv")
save.image("你的命名.RData")</span>
</code></pre>

  <div class="footer">
    <p>倪世傑 George S.J. Nee © 2025</p>
  </div>

</body>
</html>